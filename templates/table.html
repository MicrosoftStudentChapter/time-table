<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{.ClassName}} Time Table</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
      integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        background-image: url("/static/table-background.webp");
        background-size: cover;
      }
      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      /* Center the buttons */
      .button-container {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        gap: 20px;
      }

      .table-responsive {
        padding: 3%;
        max-width: 90%;
      }

      .contribution-banner {
        background-color: #212529;
        color: #ffffff;
        text-align: center;
        padding: 10px;
        margin-top: 20px;
        font-size: 0.9rem;
      }

      @media print {
        body {
          margin: 0;
          padding: 0;
          font-family: Arial, sans-serif;
        }

        @page {
          size: A4 portrait;
          margin: 0.5in;
        }

        .table-responsive {
          width: 100%;
          max-width: 100%;
          overflow: visible;
        }

        .table, .table td {
          font-size: 11px;
          padding: 3px;
          line-height: 1.4;
        }

        #timetable {
          margin-bottom: 5px;
          page-break-before: auto;
          page-break-after: auto;
          max-width: 100%;
        }

        footer {
          width: 100%;
          text-align: center;
          font-size: 8px;
          margin-top: 10px;
          padding: 5px 0;
          line-height: 1;
          page-break-before: auto;
        }

        footer p {
          margin: 0;
        }

        footer .text-warning {
          display: none; /* Removes "Project Contributors" line */
        }

        footer img {
          display: block;
          margin: 0 auto;
          width: 200px;
          height: auto;
        }

        footer .text-danger {
          font-size: 10px;
          line-height: 1.2;
          margin-bottom: 5px;
        }

        #timetable {
          margin-bottom: 5px;
          page-break-before: auto; 
          page-break-after: auto;
        }

        header {
          display: none;
        }

        body {
          padding: 0;
          margin: 0;
        }

        footer {
          max-height: 100px; /* Compress banner height */
        }
      }



    </style>
  </head>

  <body>
    <header
      style="
        margin: 1rem auto;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        width: 95vw;
      "
    >
      <a class="left" href="https://github.com/MicrosoftStudentChapter/time-table/issues">
        <img
          alt="GitHub issues"
          src="https://img.shields.io/github/issues/MicrosoftStudentChapter/time-table?style=flat&logo=github"
        />
      </a>
      <a class="right" href="https://github.com/MicrosoftStudentChapter/time-table">
        <img
          alt="GitHub Repo stars"
          src="https://img.shields.io/github/stars/MicrosoftStudentChapter/time-table?style=flat&logo=github"
        />
      </a>
    </header>

    <!-- Center the Save as PNG and Print buttons -->
    <div class="button-container">
      <button id="saveAsPng" class="btn btn-primary">Save as PNG</button>
      <button id="printPdf" class="btn btn-success">Print to PDF</button>
    </div>

    <div class="table-responsive" id="timetable">
      <table class="table table-dark table-hover" id="table">
        {{range .Data}}
        <tr class="row">
          {{range .}}
          <td
            class="bg-{{.Color}} col tablemain"
            style="
              overflow-x: auto;
              overflow-y: auto;
              max-height: 100px;
              text-align: center;
              margin: 0rem 0.3rem 0.5rem 0.3rem;
              border-radius: 0.5rem;
            "
          >
            {{.Course}}
          </td>
          {{end}}
        </tr>
        {{end}}
      </table>
    </div>

    <!-- <footer class="footer mt-2 mb-2 pb-2 pt-2 bg-dark">
      <p style="text-align: center" class="text-danger">
        Made by Utkarsh Tripathi &nbsp;
        <a href="https://github.com/MicrosoftStudentChapter" class="badge badge-success">Github</a>
        <a
          href="https://www.linkedin.com/in/utkarsh-tripathi-80a0ab192/"
          class="badge badge-primary"
          >Linkedin</a
        >
        <a href="https://utkarssh.tech" class="badge badge-dark">Website</a>
      </p>
    </footer> -->

    <footer class="footer mt-2 mb-2 pb-2 pt-2 bg-dark">
      <p style="text-align: center" class="text-danger">
        Made by Utkarsh Tripathi &nbsp;
        <a href="https://github.com/utkarsh-1905" class="badge badge-success"
          >Github</a
        >
        <a
          href="https://www.linkedin.com/in/utkarsh-tripathi-80a0ab192/"
          class="badge badge-primary"
          >Linkedin</a
        >
        <!-- <a href="https://utkarssh.tech" class="badge badge-dark">Website</a> -->
      </p>
      <p style="text-align: center" class="text-warning">
        Project contributors
      </p>
      <p style="text-align: center">
        <a
          href="https://github.com/MicrosoftStudentChapter/time-table/graphs/contributors"
        >
          <img src="https://contrib.rocks/image?repo=MicrosoftStudentChapter/time-table" />
        </a>
      </p>
    </footer>

    <!-- Add JavaScript for Save as PNG and Print -->
    <script>
      // Save as PNG logic
      document.getElementById("saveAsPng").addEventListener("click", function () {
        const timetableElement = document.getElementById("timetable");

        html2canvas(timetableElement, {
          backgroundColor: null, // Ensures transparency matches your theme
        }).then((canvas) => {
          const link = document.createElement("a");
          link.download = "timetable.png";
          link.href = canvas.toDataURL("image/png");
          link.click();
        }).catch((error) => {
          console.error("Error saving PNG:", error);
        });
      });

      // Print to PDF logic
      document.getElementById("printPdf").addEventListener("click", function () {
        const originalContent = document.body.innerHTML;
        const printContent = document.getElementById("timetable").outerHTML;
        const footerContent = document.querySelector("footer").outerHTML;

        document.body.innerHTML = printContent + footerContent;

        window.print();

        // Restore the original content after print
        document.body.innerHTML = originalContent;
        window.location.reload();
      });
    </script>
  </body>
</html>
